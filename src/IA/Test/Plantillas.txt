DELIMITER $$

CREATE FUNCTION fn_extract_hostname(texto LONGTEXT)
RETURNS VARCHAR(255)
DETERMINISTIC
BEGIN
    DECLARE resultado VARCHAR(255);

    -- Extrae todo desde hostname hasta fin de l√≠nea
    SET resultado = REGEXP_SUBSTR(
        texto,
        '(?i)(hostname|host name|host-name)[[:space:]:-]*[^[:space:]\r\n]+'
    );

    -- Quita la palabra "hostname"/variantes y deja solo el valor
    IF resultado IS NOT NULL THEN
        SET resultado = REGEXP_REPLACE(resultado, '(?i)(hostname|host name|host-name)[[:space:]:-]*', '');
        SET resultado = TRIM(BOTH ' :' FROM resultado);
    ELSE
        SET resultado = 'SIN_DATOS';
    END IF;

    RETURN resultado;
END$$

DELIMITER ;
