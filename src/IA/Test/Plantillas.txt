DELIMITER $$

CREATE FUNCTION fn_extract_hostname(texto LONGTEXT)
RETURNS VARCHAR(255)
DETERMINISTIC
BEGIN
    DECLARE resultado VARCHAR(255);

    -- Extrae después de hostname/host name/host-name hasta salto de línea
    SET resultado = REGEXP_SUBSTR(
        texto,
        '(?i)(hostname|host name|host-name)[[:space:]:-]*([^\r\n]+)',
        1,
        1,
        '',
        2
    );

    -- Limpia espacios y dos puntos
    SET resultado = TRIM(BOTH ' :' FROM resultado);

    -- Si no hay resultado, regresa 'SIN_DATOS'
    RETURN IFNULL(resultado, 'SIN_DATOS');
END$$

DELIMITER ;
